Exiled Catalan separatist leader Carles Puigdemont looks set to regain power after regional elections on Thursday, but what comes next is unlikely to be an easy ride.